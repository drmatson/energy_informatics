
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>🐼 Pandas &#8212; Energy Informatics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03_pandas_tutorial';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="🔄 Data Science Lifecycle" href="04_data_science_cycle.html" />
    <link rel="prev" title="🔢 NumPy" href="02_numpy_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Energy Informatics</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    📖 Data Science for the Digital Energy Sector
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="python.html">🐍 Python/Numpy/Pandas</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_introduction_to_python.html">🐍 Introduction to Python</a></li>

















<li class="toctree-l2"><a class="reference internal" href="02_numpy_tutorial.html">🔢 NumPy</a></li>











<li class="toctree-l2 current active"><a class="current reference internal" href="#">🐼 Pandas</a></li>



















</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="04_data_science_cycle.html">🔄 Data Science Lifecycle</a></li>







<li class="toctree-l1 has-children"><a class="reference internal" href="visualization.html">👀 Visualisation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="05_visualization.html">📊 Visualization Tutorial with Matplotlib &amp; Seaborn</a></li>












<li class="toctree-l2"><a class="reference internal" href="06_plotly.html">⚡ Plotly</a></li>










<li class="toctree-l2"><a class="reference internal" href="07_ipywidgets.html">⚙️ Interactive Controls in Jupyter (ipywidgets)</a></li>










<li class="toctree-l2"><a class="reference internal" href="08_dash.html">⚡ Dash for Energy Analytics — Mini Tutorial</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data preprocessing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="09_handling_datetime.html">🕒 Handling Datetime</a></li>




<li class="toctree-l1"><a class="reference internal" href="10_handling_missing_data.html">🔧 Handling Missing Data</a></li>







<li class="toctree-l1"><a class="reference internal" href="11_outliers.html">📊 Outliers in Data</a></li>



<li class="toctree-l1"><a class="reference internal" href="12_feature_engineering.html">🔧 Feature Engineering Tutorial</a></li>









</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelling time series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ts.html">⏱️ Time Series vs. 📌 Timestamped Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_timeseries_intro.html">Time series: trend, seasonality, decomposition.</a></li>









</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/03_pandas_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>🐼 Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">🐼 Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">📌 What is Pandas?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">📦 Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import">🐍 Import</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#series">📊 Series</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframes">🏢 Pandas: DataFrames</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries-vs-data-frame-difference-df-x-vs-df-x">🔎 Timeseries vs. Data frame. Difference: <code class="docutils literal notranslate"><span class="pre">df['x']</span></code> vs <code class="docutils literal notranslate"><span class="pre">df[['x']]</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-difference">🎯 Key Difference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-demand-series">✅ <code class="docutils literal notranslate"><span class="pre">df['demand']</span></code> → <strong>Series</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-demand-dataframe">✅ <code class="docutils literal notranslate"><span class="pre">df[['Demand']]</span></code> → <strong>DataFrame</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-data-in-pandas">📋 Inspecting Data in Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-df-info">ℹ️ <code class="docutils literal notranslate"><span class="pre">df.info()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-index-and-df-columns">🏷️ <code class="docutils literal notranslate"><span class="pre">df.index</span></code> and <code class="docutils literal notranslate"><span class="pre">df.columns</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-head-and-df-tail">👀 <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#len-df">📏 <code class="docutils literal notranslate"><span class="pre">len(df)</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">📊 Descriptive Statistics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics-with-describe">📊 Descriptive Statistics with <code class="docutils literal notranslate"><span class="pre">.describe()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics-for-mixed-data">📊 Descriptive Statistics for Mixed Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notes">🔎 Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-counts-with-value-counts">🔢 Frequency Counts with <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-its-useful">🔎 Why it’s useful?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unique-values-with-unique-and-nunique">🎯 Unique Values with <code class="docutils literal notranslate"><span class="pre">.unique()</span></code> and <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">🔎 Why it’s useful?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-rows-and-columns-in-pandas">📑 Accessing Rows and Columns in Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-columns">🎯 Calling Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-rows">🎯 Calling Rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rows-columns-together">🎯 Rows + Columns Together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">📌 Summary</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#selection-helpers-at-and-iat">🎯 Selection Helpers: <code class="docutils literal notranslate"><span class="pre">.at[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iat[]</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-points">🔎 Key Points</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-rows-and-columns">🗑️ Dropping Rows and Columns</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">🔗 Concatenation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#row-wise-concatenation">📑 Row-wise Concatenation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#column-wise-concatenation">📑 Column-wise Concatenation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">🔎 Key Points</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#joins-and-merges">🔀 Joins and Merges</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">🔎 Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-join-default">✅ Inner Join (default)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#left-join">✅ Left Join</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#right-join">✅ Right Join</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-join">✅ Outer Join</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">🔎 Filtering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-boolean-masks">🔎 Filtering (Boolean Masks)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-with-query">🔎 Filtering with <code class="docutils literal notranslate"><span class="pre">.query()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-benefits">🔎 Key Benefits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-columns-apply">➕ Derived Columns &amp; <code class="docutils literal notranslate"><span class="pre">.apply()</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-apply">🔎 Why use <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-aggregations">🧮 GroupBy &amp; Aggregations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">🔎 Key Points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-totals-by-plant">⚡ Example: Totals by Plant</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-multiple-columns">⚡ Group by Multiple Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-agg-with-custom-functions">⚡ Using <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> with Custom Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-ranking">🧭 Sorting &amp; Ranking</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-melt-and-pivot">🔁 Reshaping: <code class="docutils literal notranslate"><span class="pre">melt</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters">🔎 Why This Matters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-tables">📊 Pivot Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing-set-index-reset-index-multiindex">🧱 Indexing: <code class="docutils literal notranslate"><span class="pre">set_index</span></code>, <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>, MultiIndex</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime-time-series">⏱️ DateTime / Time Series</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#string-operations">🔤 String Operations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-powerful-regex-example">⚡ More Powerful Regex Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaway">🔎 Key Takeaway</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#categoricals">🏷️ Categoricals</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#window-functions-rolling">🪟 Window Functions (<code class="docutils literal notranslate"><span class="pre">rolling</span></code>)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns-and-rows">✏️ Renaming Columns and Rows</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-notes">🔎 Key Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns">⚡ Renaming Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-rows-index">⚡ Renaming Rows (Index)</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas">
<h1>🐼 Pandas<a class="headerlink" href="#pandas" title="Link to this heading">#</a></h1>
<section id="what-is-pandas">
<h2>📌 What is Pandas?<a class="headerlink" href="#what-is-pandas" title="Link to this heading">#</a></h2>
<p><strong>Pandas</strong> is a Python library for <strong>data analysis and manipulation</strong>.</p>
<ul class="simple">
<li><p>Built on top of <strong>NumPy</strong>.</p></li>
<li><p>Provides two main data structures:</p>
<ul>
<li><p><strong>Series</strong> → one-dimensional labeled array (like a column).</p></li>
<li><p><strong>DataFrame</strong> → two-dimensional table (like Excel or SQL).</p></li>
</ul>
</li>
<li><p>Makes it easy to <strong>clean, transform, join, and analyze data</strong>.</p></li>
</ul>
<p>⚡ It’s the <strong>go-to library</strong> for working with datasets in data science, machine learning, and energy analytics.</p>
</section>
<hr class="docutils" />
<section id="installation">
<h2>📦 Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p>If Pandas is not already installed, you can add it using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pandas
</pre></div>
</div>
<p>or (if using Anaconda):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>pandas
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="import">
<h2>🐍 Import<a class="headerlink" href="#import" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Check version</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<p>✅ By convention, Pandas is always imported as <strong><code class="docutils literal notranslate"><span class="pre">pd</span></code></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="series">
<h1>📊 Series<a class="headerlink" href="#series" title="Link to this heading">#</a></h1>
<p>A <strong>Series</strong> is a one-dimensional labeled array in Pandas.<br />
Think of it as a <strong>column of data</strong> (like Excel), with both values and labels (index).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Daily solar energy production (MWh)</span>
<span class="n">solar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span> 
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Day 1    120
Day 2    135
Day 3    150
Day 4    160
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar</span><span class="o">/</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Day 1    1.20
Day 2    1.35
Day 3    1.50
Day 4    1.60
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can select label-based or using<code class="docutils literal notranslate"><span class="pre">.iloc</span></code> (index-based).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>120
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>120
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Day 1&#39;, &#39;Day 2&#39;, &#39;Day 3&#39;, &#39;Day 4&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pandas-dataframes">
<h1>🏢 Pandas: DataFrames<a class="headerlink" href="#pandas-dataframes" title="Link to this heading">#</a></h1>
<p>A <strong>DataFrame</strong> is a two-dimensional labeled data structure (rows × columns).<br />
It’s like an <strong>Excel table</strong> or <strong>SQL table</strong>.</p>
<p>⚡ Example: production data for multiple plants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production (MWh) for 3 plants over 4 days</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Solar  Wind  Hydro
Day 1    120   200    300
Day 2    135   210    310
Day 3    150   190    305
Day 4    160   220    295
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="timeseries-vs-data-frame-difference-df-x-vs-df-x">
<h1>🔎 Timeseries vs. Data frame. Difference: <code class="docutils literal notranslate"><span class="pre">df['x']</span></code> vs <code class="docutils literal notranslate"><span class="pre">df[['x']]</span></code><a class="headerlink" href="#timeseries-vs-data-frame-difference-df-x-vs-df-x" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<section id="key-difference">
<h2>🎯 Key Difference<a class="headerlink" href="#key-difference" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Series</strong> (<code class="docutils literal notranslate"><span class="pre">df['col']</span></code>) → 1D, easy for quick calculations.</p></li>
<li><p><strong>DataFrame</strong> (<code class="docutils literal notranslate"><span class="pre">df[['col']]</span></code>) → 2D, keeps the “table” structure, useful when selecting <strong>multiple columns</strong> or when functions require a DataFrame.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Demand&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Production&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">170</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="df-demand-series">
<h2>✅ <code class="docutils literal notranslate"><span class="pre">df['demand']</span></code> → <strong>Series</strong><a class="headerlink" href="#df-demand-series" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Returns a <strong>one-dimensional object</strong>.</p></li>
<li><p>Acts like a single labeled column.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Demand&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Demand&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Day 1    120
Day 2    135
Day 3    150
Day 4    160
Name: Demand, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="df-demand-dataframe">
<h2>✅ <code class="docutils literal notranslate"><span class="pre">df[['Demand']]</span></code> → <strong>DataFrame</strong><a class="headerlink" href="#df-demand-dataframe" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Returns a <strong>two-dimensional object</strong>.</p></li>
<li><p>Acts like a <strong>new DataFrame</strong> with just that column.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Demand&quot;</span><span class="p">]]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Demand&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
       Demand
Day 1     120
Day 2     135
Day 3     150
Day 4     160
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="inspecting-data-in-pandas">
<h1>📋 Inspecting Data in Pandas<a class="headerlink" href="#inspecting-data-in-pandas" title="Link to this heading">#</a></h1>
<p>When working with a dataset, you often want to <strong>look at its structure</strong> before doing any analysis. Pandas provides several useful methods:</p>
<hr class="docutils" />
<section id="i-df-info">
<h2>ℹ️ <code class="docutils literal notranslate"><span class="pre">df.info()</span></code><a class="headerlink" href="#i-df-info" title="Link to this heading">#</a></h2>
<p>Gives a quick summary of the DataFrame (index, column names, data types, non-null counts).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 4 entries, Day 1 to Day 4
Data columns (total 2 columns):
 #   Column      Non-Null Count  Dtype
---  ------      --------------  -----
 0   Demand      4 non-null      int64
 1   Production  4 non-null      int64
dtypes: int64(2)
memory usage: 96.0+ bytes
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="df-index-and-df-columns">
<h2>🏷️ <code class="docutils literal notranslate"><span class="pre">df.index</span></code> and <code class="docutils literal notranslate"><span class="pre">df.columns</span></code><a class="headerlink" href="#df-index-and-df-columns" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">index</span></code></strong> → labels of the rows (here: days).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">columns</span></code></strong> → names of the columns (here: energy sources).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>    <span class="c1"># Index([&#39;Day 1&#39;, &#39;Day 2&#39;, &#39;Day 3&#39;, &#39;Day 4&#39;], dtype=&#39;object&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Index([&#39;Solar&#39;, &#39;Wind&#39;, &#39;Hydro&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Day 1&#39;, &#39;Day 2&#39;, &#39;Day 3&#39;, &#39;Day 4&#39;], dtype=&#39;object&#39;)
Index([&#39;Demand&#39;, &#39;Production&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="df-head-and-df-tail">
<h2>👀 <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code><a class="headerlink" href="#df-head-and-df-tail" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">head()</span></code></strong> → shows the first 5 rows (or a given number).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tail()</span></code></strong> → shows the last 5 rows (or a given number).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>   <span class="c1"># First 2 days</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>   <span class="c1"># Last 2 days</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Demand  Production
Day 1     120         110
Day 2     135         140
       Demand  Production
Day 3     150         155
Day 4     160         170
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="len-df">
<h2>📏 <code class="docutils literal notranslate"><span class="pre">len(df)</span></code><a class="headerlink" href="#len-df" title="Link to this heading">#</a></h2>
<p>Returns the number of rows in the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>  <span class="c1"># 4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="descriptive-statistics">
<h1>📊 Descriptive Statistics<a class="headerlink" href="#descriptive-statistics" title="Link to this heading">#</a></h1>
<section id="descriptive-statistics-with-describe">
<h2>📊 Descriptive Statistics with <code class="docutils literal notranslate"><span class="pre">.describe()</span></code><a class="headerlink" href="#descriptive-statistics-with-describe" title="Link to this heading">#</a></h2>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">.describe()</span></code></strong> method in Pandas quickly calculates <strong>summary statistics</strong> for numerical columns:</p>
<ul class="simple">
<li><p><strong>count</strong> → number of non-null values</p></li>
<li><p><strong>mean</strong> → average</p></li>
<li><p><strong>std</strong> → standard deviation</p></li>
<li><p><strong>min</strong>, <strong>max</strong> → smallest and largest values</p></li>
<li><p><strong>25%, 50%, 75%</strong> → percentiles (quartiles)</p></li>
</ul>
<p>Why???</p>
<ul class="simple">
<li><p>Quickly shows <strong>distribution</strong> of data (min, max, spread).</p></li>
<li><p>Helps spot <strong>outliers</strong> or suspicious values.</p></li>
<li><p>Essential first step in <strong>exploratory data analysis (EDA)</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Demand</th>
      <th>Production</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.00</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>141.25</td>
      <td>143.750000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>17.50</td>
      <td>25.617377</td>
    </tr>
    <tr>
      <th>min</th>
      <td>120.00</td>
      <td>110.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>131.25</td>
      <td>132.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>142.50</td>
      <td>147.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>152.50</td>
      <td>158.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>160.00</td>
      <td>170.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Demand</th>
      <td>4.0</td>
      <td>141.25</td>
      <td>17.500000</td>
      <td>120.0</td>
      <td>131.25</td>
      <td>142.5</td>
      <td>152.50</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>Production</th>
      <td>4.0</td>
      <td>143.75</td>
      <td>25.617377</td>
      <td>110.0</td>
      <td>132.50</td>
      <td>147.5</td>
      <td>158.75</td>
      <td>170.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="descriptive-statistics-for-mixed-data">
<h2>📊 Descriptive Statistics for Mixed Data<a class="headerlink" href="#descriptive-statistics-for-mixed-data" title="Link to this heading">#</a></h2>
<p>By default, <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> only summarizes <strong>numeric columns</strong>.
To include <strong>all columns</strong> (numbers, text, categories, booleans), use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="notes">
<h3>🔎 Notes<a class="headerlink" href="#notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>For <strong>categorical columns</strong>: shows <strong>unique values</strong>, most frequent (<strong>top</strong>), and <strong>frequency</strong>.</p></li>
<li><p>For <strong>numeric columns</strong>: shows full statistics (count, mean, std, percentiles).</p></li>
</ul>
<p>👉 This is very handy for <strong>mixed energy datasets</strong> (e.g., plant types, regions, and production values).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;North&quot;</span><span class="p">,</span> <span class="s2">&quot;East&quot;</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">,</span> <span class="s2">&quot;North&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Production (MWh)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Region</th>
      <th>Production (MWh)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4</td>
      <td>4</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>3</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Solar</td>
      <td>North</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>196.250000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>81.585844</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>120.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>142.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>180.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>233.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>305.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="frequency-counts-with-value-counts">
<h2>🔢 Frequency Counts with <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code><a class="headerlink" href="#frequency-counts-with-value-counts" title="Link to this heading">#</a></h2>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code></strong> method shows how often each value appears in a column (or Series).
It’s great for understanding <strong>categorical distributions</strong>.</p>
<section id="why-its-useful">
<h3>🔎 Why it’s useful?<a class="headerlink" href="#why-its-useful" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Quickly see <strong>distribution of categories</strong> (e.g., which plants dominate).</p></li>
<li><p>Helpful for <strong>imbalanced datasets</strong> (e.g., one region has much more data).</p></li>
<li><p>Works well with <code class="docutils literal notranslate"><span class="pre">.normalize=True</span></code> to get <strong>percentages</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;North&quot;</span><span class="p">,</span> <span class="s2">&quot;East&quot;</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">,</span> <span class="s2">&quot;North&quot;</span><span class="p">,</span> <span class="s2">&quot;East&quot;</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Count how many times each plant type appears</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Plant&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># Count how many times each region appears</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plant
Solar    3
Wind     2
Hydro    1
Name: count, dtype: int64
Region
North    2
East     2
West     2
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Plant&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plant
Solar    0.500000
Wind     0.333333
Hydro    0.166667
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="unique-values-with-unique-and-nunique">
<h2>🎯 Unique Values with <code class="docutils literal notranslate"><span class="pre">.unique()</span></code> and <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code><a class="headerlink" href="#unique-values-with-unique-and-nunique" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.unique()</span></code></strong> → returns an array of unique values in a Series.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.nunique()</span></code></strong> → returns the number of unique values.</p></li>
</ul>
<p>These are useful for quickly checking what categories exist in your data.</p>
<section id="id1">
<h3>🔎 Why it’s useful?<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.unique()</span></code></strong> → see what categories exist (e.g., Solar, Wind, Hydro).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.nunique()</span></code></strong> → check diversity (how many different categories are present).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;North&quot;</span><span class="p">,</span> <span class="s2">&quot;East&quot;</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">,</span> <span class="s2">&quot;North&quot;</span><span class="p">,</span> <span class="s2">&quot;East&quot;</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Unique plant types</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique plants:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Plant&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># Number of unique plant types</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of unique plants:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Plant&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="c1"># Unique regions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique regions:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># Number of unique regions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of unique regions:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique plants: [&#39;Solar&#39; &#39;Wind&#39; &#39;Hydro&#39;]
Number of unique plants: 3
Unique regions: [&#39;North&#39; &#39;East&#39; &#39;West&#39;]
Number of unique regions: 3
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="accessing-rows-and-columns-in-pandas">
<h1>📑 Accessing Rows and Columns in Pandas<a class="headerlink" href="#accessing-rows-and-columns-in-pandas" title="Link to this heading">#</a></h1>
<p>In Pandas, you can select <strong>columns</strong> and <strong>rows</strong> in different ways depending on whether you use <strong>labels</strong> or <strong>positions</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production dataset (MWh)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
<section id="calling-columns">
<h2>🎯 Calling Columns<a class="headerlink" href="#calling-columns" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Single column as Series</strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Day 1    120
Day 2    135
Day 3    150
Day 4    160
Name: Solar, dtype: int64
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Single column as DataFrame</strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Multiple columns</strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="calling-rows">
<h2>🎯 Calling Rows<a class="headerlink" href="#calling-rows" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>By label → <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code></strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">]</span>        <span class="c1"># row by index label</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">]]</span>  <span class="c1"># multiple rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>By integer position → <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># first row</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># slice rows 2–3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="rows-columns-together">
<h2>🎯 Rows + Columns Together<a class="headerlink" href="#rows-columns-together" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Label-based → <code class="docutils literal notranslate"><span class="pre">.loc[row,</span> <span class="pre">column]</span></code></strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Solar&quot;</span><span class="p">]</span>    <span class="c1"># single value</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">]]</span>  <span class="c1"># subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Position-based → <code class="docutils literal notranslate"><span class="pre">.iloc[row,</span> <span class="pre">column]</span></code></strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1"># single value (row 2, col 1)</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># first 2 rows, first 2 cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="summary">
<h2>📌 Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">[]</span></code></strong> → quick way for columns only.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.loc[]</span></code></strong> → selection by <strong>labels</strong> (rows, cols).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></strong> → selection by <strong>integer positions</strong>.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="selection-helpers-at-and-iat">
<h1>🎯 Selection Helpers: <code class="docutils literal notranslate"><span class="pre">.at[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iat[]</span></code><a class="headerlink" href="#selection-helpers-at-and-iat" title="Link to this heading">#</a></h1>
<p>Sometimes you only need a <strong>single value</strong> (scalar) from your DataFrame.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.at[row_label,</span> <span class="pre">col_label]</span></code></strong> → access by <strong>labels</strong> (fastest).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.iat[row_index,</span> <span class="pre">col_index]</span></code></strong> → access by <strong>integer positions</strong> (fastest).</p></li>
</ul>
<p>These are optimized for quick <strong>scalar lookups</strong>.</p>
<section id="key-points">
<h2>🔎 Key Points<a class="headerlink" href="#key-points" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.at[]</span></code> when you know the <strong>row + column labels</strong>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.iat[]</span></code> when you know the <strong>row + column positions</strong>.</p></li>
<li><p>Both are <strong>faster</strong> than <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> when selecting a single cell.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production dataset (MWh)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="c1"># Get Hydro production on Day 3</span>
<span class="n">val1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">]</span>   <span class="c1"># label-based</span>
<span class="n">val2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>              <span class="c1"># index-based</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using .at[]:&quot;</span><span class="p">,</span> <span class="n">val1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using .iat[]:&quot;</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using .at[]: 305
Using .iat[]: 305
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="dropping-rows-and-columns">
<h1>🗑️ Dropping Rows and Columns<a class="headerlink" href="#dropping-rows-and-columns" title="Link to this heading">#</a></h1>
<p>You can remove <strong>rows</strong> or <strong>columns</strong> from a DataFrame using <code class="docutils literal notranslate"><span class="pre">.drop()</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.drop(&quot;col&quot;,</span> <span class="pre">axis=1)</span></code> → drop a column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.drop(&quot;row&quot;,</span> <span class="pre">axis=0)</span></code> → drop a row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> → modify the DataFrame directly</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production dataset (MWh)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># Drop a column (remove Hydro data)</span>
<span class="n">df_no_hydro</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Hydro&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After dropping Hydro column:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df_no_hydro</span><span class="p">)</span>

<span class="c1"># Drop a row (remove Day 4)</span>
<span class="n">df_no_day4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Day 4&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After dropping Day 4:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df_no_day4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
        Solar  Wind  Hydro
Day 1    120   200    300
Day 2    135   210    310
Day 3    150   190    305
Day 4    160   220    295

After dropping Hydro column:
        Solar  Wind
Day 1    120   200
Day 2    135   210
Day 3    150   190
Day 4    160   220

After dropping Day 4:
        Solar  Wind  Hydro
Day 1    120   200    300
Day 2    135   210    310
Day 3    150   190    305
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="concatenation">
<h1>🔗 Concatenation<a class="headerlink" href="#concatenation" title="Link to this heading">#</a></h1>
<p>In Pandas, you can combine multiple <strong>DataFrames</strong> using <strong><code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code></strong>.</p>
<ul class="simple">
<li><p>Works <strong>row-wise</strong> (stacking one below the other).</p></li>
<li><p>Or <strong>column-wise</strong> (side by side).</p></li>
</ul>
<section id="row-wise-concatenation">
<h2>📑 Row-wise Concatenation<a class="headerlink" href="#row-wise-concatenation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Week 1 production (MWh)</span>
<span class="n">week1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">,</span><span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="c1"># Week 2 production (MWh)</span>
<span class="n">week2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">165</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">210</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">230</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">310</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">305</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 5&quot;</span><span class="p">,</span><span class="s2">&quot;Day 6&quot;</span><span class="p">,</span><span class="s2">&quot;Day 7&quot;</span><span class="p">,</span><span class="s2">&quot;Day 8&quot;</span><span class="p">])</span>

<span class="c1"># Concatenate row-wise (stack weeks)</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">week1</span><span class="p">,</span> <span class="n">week2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Solar  Wind  Hydro
Day 1    120   200    300
Day 2    135   210    310
Day 3    150   190    305
Day 4    160   220    295
Day 5    165   210    310
Day 6    170   215    320
Day 7    175   225    315
Day 8    180   230    305
</pre></div>
</div>
</div>
</div>
<p>✅ This stacks <strong>Week 2 below Week 1</strong> into one DataFrame.</p>
</section>
<hr class="docutils" />
<section id="column-wise-concatenation">
<h2>📑 Column-wise Concatenation<a class="headerlink" href="#column-wise-concatenation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a new DataFrame with prices (aligned by index)</span>
<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Price (€/MWh)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">,</span><span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="n">merged_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">week1</span><span class="p">,</span> <span class="n">prices</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Solar  Wind  Hydro  Price (€/MWh)
Day 1    120   200    300             50
Day 2    135   210    310             40
Day 3    150   190    305             30
Day 4    160   220    295             45
</pre></div>
</div>
</div>
</div>
<p>✅ This places <strong>prices next to production data</strong>.</p>
<hr class="docutils" />
<section id="id2">
<h3>🔎 Key Points<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">axis=0</span></code> (default) → stack rows (like appending more days).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis=1</span></code> → add columns (like extra info for same days).</p></li>
</ul>
<p>👉 Concatenation is useful for combining <strong>time periods</strong> or <strong>adding extra info</strong> to your datasets.</p>
<p>⚠️ <strong>Note on <code class="docutils literal notranslate"><span class="pre">.append()</span></code></strong></p>
<ul class="simple">
<li><p>Older Pandas versions allowed <code class="docutils literal notranslate"><span class="pre">df1.append(df2)</span></code>.</p></li>
<li><p><strong>It is now deprecated</strong> 🚫 and will be removed in future versions.</p></li>
<li><p>✅ Use <strong><code class="docutils literal notranslate"><span class="pre">pd.concat([df1,</span> <span class="pre">df2])</span></code></strong> instead — it’s faster, more flexible, and the recommended way.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="joins-and-merges">
<h1>🔀 Joins and Merges<a class="headerlink" href="#joins-and-merges" title="Link to this heading">#</a></h1>
<p>In Pandas, <strong>merging</strong> works like <strong>SQL joins</strong> — it combines two DataFrames based on a <strong>common key column</strong>.</p>
<ul class="simple">
<li><p><strong>Inner Join</strong> → only rows with matching keys (default).</p></li>
<li><p><strong>Left Join</strong> → keep all rows from the left DataFrame.</p></li>
<li><p><strong>Right Join</strong> → keep all rows from the right DataFrame.</p></li>
<li><p><strong>Outer Join</strong> → keep all rows from both, fill missing with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
</ul>
<hr class="docutils" />
<section id="id3">
<h2>🔎 Summary<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Join</strong> = combining two datasets by a key.</p></li>
<li><p><strong>Types of joins</strong> decide <strong>what happens to non-matching rows</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Production data</span>
<span class="n">production</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Production (MWh)&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Price data</span>
<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Price (€/MWh)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="inner-join-default">
<h2>✅ Inner Join (default)<a class="headerlink" href="#inner-join-default" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_inner</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">merged_inner</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Production (MWh)</th>
      <th>Price (€/MWh)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wind</td>
      <td>200</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="left-join">
<h2>✅ Left Join<a class="headerlink" href="#left-join" title="Link to this heading">#</a></h2>
<p>Keeps <strong>all plants from <code class="docutils literal notranslate"><span class="pre">production</span></code></strong>, even if missing prices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">merged_left</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Production (MWh)</th>
      <th>Price (€/MWh)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wind</td>
      <td>200</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hydro</td>
      <td>300</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="right-join">
<h2>✅ Right Join<a class="headerlink" href="#right-join" title="Link to this heading">#</a></h2>
<p>Keeps <strong>all plants from <code class="docutils literal notranslate"><span class="pre">prices</span></code></strong>, even if missing production.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">merged_right</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Production (MWh)</th>
      <th>Price (€/MWh)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Solar</td>
      <td>NaN</td>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Wind</td>
      <td>200.0</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="outer-join">
<h2>✅ Outer Join<a class="headerlink" href="#outer-join" title="Link to this heading">#</a></h2>
<p>Keeps <strong>all plants from both</strong> DataFrames. Missing values filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_outer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">merged_outer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Production (MWh)</th>
      <th>Price (€/MWh)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hydro</td>
      <td>300.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Solar</td>
      <td>NaN</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Wind</td>
      <td>200.0</td>
      <td>40.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">merged</span><span class="p">[</span><span class="s2">&quot;Revenue (€)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;Production (MWh)&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;Price (€/MWh)&quot;</span><span class="p">]</span>
<span class="n">merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Plant</th>
      <th>Production (MWh)</th>
      <th>Price (€/MWh)</th>
      <th>Revenue (€)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hydro</td>
      <td>300.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Solar</td>
      <td>NaN</td>
      <td>50.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Wind</td>
      <td>200.0</td>
      <td>40.0</td>
      <td>8000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="filtering">
<h1>🔎 Filtering<a class="headerlink" href="#filtering" title="Link to this heading">#</a></h1>
<section id="filtering-boolean-masks">
<h2>🔎 Filtering (Boolean Masks)<a class="headerlink" href="#filtering-boolean-masks" title="Link to this heading">#</a></h2>
<p>Use boolean conditions to filter rows.
We can filter rows in a DataFrame using <strong>boolean conditions</strong>.</p>
<ul class="simple">
<li><p>A condition returns <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code> for each row.</p></li>
<li><p>Only rows where the condition is <code class="docutils literal notranslate"><span class="pre">True</span></code> are selected.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Energy production dataset (MWh)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="c1"># Select days where solar &gt; 140 MWh</span>
<span class="n">filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">]</span>
<span class="n">filtered</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Days where Wind = 210</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Wind&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">210</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Days where Hydro &lt; 300</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Hydro&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multiple conditions (use `&amp;` for AND, `|` for OR)</span>
<span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">130</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Wind&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="filtering-with-query">
<h2>🔎 Filtering with <code class="docutils literal notranslate"><span class="pre">.query()</span></code><a class="headerlink" href="#filtering-with-query" title="Link to this heading">#</a></h2>
<p>Instead of writing boolean masks with brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code>, you can use <strong><code class="docutils literal notranslate"><span class="pre">.query()</span></code></strong>:</p>
<ul class="simple">
<li><p>Conditions are written as a <strong>string</strong>.</p></li>
<li><p>Column names are used directly (without <code class="docutils literal notranslate"><span class="pre">df[&quot;col&quot;]</span></code>).</p></li>
<li><p>Makes complex filters easier to read.</p></li>
</ul>
<section id="key-benefits">
<h3>🔎 Key Benefits<a class="headerlink" href="#key-benefits" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Cleaner syntax</strong> (no brackets, no <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>/<code class="docutils literal notranslate"><span class="pre">|</span></code>).</p></li>
<li><p>Feels familiar if you know <strong>SQL</strong>.</p></li>
<li><p>Great for complex queries.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Days where Solar &gt; 140</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Solar &gt; 140&quot;</span><span class="p">))</span>

<span class="c1"># Days where Wind == 210</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Wind == 210&quot;</span><span class="p">))</span>

<span class="c1"># Days where Hydro &lt; 300</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Hydro &lt; 300&quot;</span><span class="p">))</span>

<span class="c1"># Multiple conditions (AND / OR)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Solar &gt; 130 and Wind &gt; 200&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Solar &gt; 150 or Hydro &lt; 300&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Solar  Wind  Hydro
Day 3    150   190    305
Day 4    160   220    295
       Solar  Wind  Hydro
Day 2    135   210    310
       Solar  Wind  Hydro
Day 4    160   220    295
       Solar  Wind  Hydro
Day 2    135   210    310
Day 4    160   220    295
       Solar  Wind  Hydro
Day 4    160   220    295
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="derived-columns-apply">
<h1>➕ Derived Columns &amp; <code class="docutils literal notranslate"><span class="pre">.apply()</span></code><a class="headerlink" href="#derived-columns-apply" title="Link to this heading">#</a></h1>
<p>You can create <strong>new columns</strong> from existing ones using operations or <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> with a custom function.</p>
<section id="why-use-apply">
<h2>🔎 Why use <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>?<a class="headerlink" href="#why-use-apply" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Add <strong>custom logic</strong> (e.g., classify, transform, label).</p></li>
<li><p>Works <strong>row-wise</strong> (<code class="docutils literal notranslate"><span class="pre">axis=1</span></code>) or <strong>column-wise</strong> (<code class="docutils literal notranslate"><span class="pre">axis=0</span></code>).</p></li>
<li><p>More flexible than simple arithmetic operations.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="c1"># Total production</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Wind&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Hydro&quot;</span><span class="p">]</span>

<span class="c1"># Solar share (% of total)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar_share_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
      <th>Total</th>
      <th>Solar_share_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
      <td>620</td>
      <td>19.35</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
      <td>655</td>
      <td>20.61</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
      <td>645</td>
      <td>23.26</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
      <td>675</td>
      <td>23.70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to classify days as &quot;High&quot; or &quot;Low&quot; production</span>
<span class="k">def</span> <span class="nf">classify_day</span><span class="p">(</span><span class="n">total</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;High&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Low&quot;</span>

<span class="c1"># Apply function to Total column</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Production_Level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">classify_day</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
      <th>Total</th>
      <th>Solar_share_%</th>
      <th>Production_Level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
      <td>620</td>
      <td>19.354839</td>
      <td>High</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
      <td>655</td>
      <td>20.610687</td>
      <td>High</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
      <td>645</td>
      <td>23.255814</td>
      <td>High</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
      <td>675</td>
      <td>23.703704</td>
      <td>High</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="groupby-aggregations">
<h1>🧮 GroupBy &amp; Aggregations<a class="headerlink" href="#groupby-aggregations" title="Link to this heading">#</a></h1>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">.groupby()</span></code></strong> method lets you <strong>split data into groups</strong>, apply an <strong>aggregation</strong> (like sum, mean), and then <strong>combine the results</strong>.
This is very useful for <strong>summarizing datasets</strong>.</p>
<section id="id4">
<h2>🔎 Key Points<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.groupby(&quot;col&quot;)</span></code></strong> → splits data by column values.</p></li>
<li><p>Combine with <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">.max()</span></code>, <code class="docutils literal notranslate"><span class="pre">.min()</span></code>, <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> for summaries.</p></li>
<li><p>Works with <strong>multiple group keys</strong> (like Plant + Region).</p></li>
<li><p>Supports <strong>custom functions</strong> for flexible analysis.</p></li>
</ul>
</section>
<section id="example-totals-by-plant">
<h2>⚡ Example: Totals by Plant<a class="headerlink" href="#example-totals-by-plant" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Hydro&quot;</span><span class="p">,</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Hydro&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MWh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Total production per plant</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Plant&quot;</span><span class="p">)[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">)</span>

<span class="c1"># Multiple aggregations</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Plant&quot;</span><span class="p">)[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span><span class="s2">&quot;min&quot;</span><span class="p">,</span><span class="s2">&quot;max&quot;</span><span class="p">,</span><span class="s2">&quot;sum&quot;</span><span class="p">])</span>
<span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plant
Hydro    595
Solar    280
Wind     420
Name: MWh, dtype: int64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>min</th>
      <th>max</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>Plant</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hydro</th>
      <td>297.5</td>
      <td>295</td>
      <td>300</td>
      <td>595</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>140.0</td>
      <td>120</td>
      <td>160</td>
      <td>280</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>210.0</td>
      <td>200</td>
      <td>220</td>
      <td>420</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="group-by-multiple-columns">
<h2>⚡ Group by Multiple Columns<a class="headerlink" href="#group-by-multiple-columns" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example with Region</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Hydro&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;North&quot;</span><span class="p">,</span><span class="s2">&quot;East&quot;</span><span class="p">,</span><span class="s2">&quot;North&quot;</span><span class="p">,</span><span class="s2">&quot;East&quot;</span><span class="p">,</span><span class="s2">&quot;West&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MWh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Total per Plant + Region</span>
<span class="n">totals</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span><span class="s2">&quot;Plant&quot;</span><span class="p">])[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">totals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Region  Plant
East    Wind     420
North   Solar    280
West    Hydro    295
Name: MWh, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="using-agg-with-custom-functions">
<h2>⚡ Using <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> with Custom Functions<a class="headerlink" href="#using-agg-with-custom-functions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a custom function</span>
<span class="k">def</span> <span class="nf">range_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="c1"># Apply multiple aggregations including custom</span>
<span class="n">custom_stats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Plant&quot;</span><span class="p">)[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">range_func</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">custom_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        mean  sum  range_func
Plant                        
Hydro  297.5  595           5
Solar  140.0  280          40
Wind   210.0  420          20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Plant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Hydro&quot;</span><span class="p">,</span><span class="s2">&quot;Solar&quot;</span><span class="p">,</span><span class="s2">&quot;Wind&quot;</span><span class="p">,</span><span class="s2">&quot;Hydro&quot;</span><span class="p">],</span>
    <span class="s2">&quot;MWh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Plant&quot;</span><span class="p">)[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">grouped</span>  <span class="c1"># totals per plant</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plant
Hydro    595
Solar    280
Wind     420
Name: MWh, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Plant&quot;</span><span class="p">)[</span><span class="s2">&quot;MWh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span><span class="s2">&quot;min&quot;</span><span class="p">,</span><span class="s2">&quot;max&quot;</span><span class="p">,</span><span class="s2">&quot;sum&quot;</span><span class="p">])</span>
<span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>min</th>
      <th>max</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>Plant</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hydro</th>
      <td>297.5</td>
      <td>295</td>
      <td>300</td>
      <td>595</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>140.0</td>
      <td>120</td>
      <td>160</td>
      <td>280</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>210.0</td>
      <td>200</td>
      <td>220</td>
      <td>420</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="sorting-ranking">
<h2>🧭 Sorting &amp; Ranking<a class="headerlink" href="#sorting-ranking" title="Link to this heading">#</a></h2>
<p>Sort by values or index; compute ranks.</p>
<p>⚡ Example: sort days by <strong>Total MWh</strong> descending.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production (MWh) for 3 plants over 4 days</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">,</span><span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a copy and compute totals (only numeric columns)</span>
<span class="n">df_sort</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_sort</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sort</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sort</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
      <td>620</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
      <td>655</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
      <td>645</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
      <td>675</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort by total production (descending)</span>
<span class="n">df_sort</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Total&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 4</th>
      <td>160</td>
      <td>220</td>
      <td>295</td>
      <td>675</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>135</td>
      <td>210</td>
      <td>310</td>
      <td>655</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>150</td>
      <td>190</td>
      <td>305</td>
      <td>645</td>
    </tr>
    <tr>
      <th>Day 1</th>
      <td>120</td>
      <td>200</td>
      <td>300</td>
      <td>620</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rank plants by Day 1 output (highest = 1)</span>
<span class="n">day1_ranking</span> <span class="o">=</span> <span class="n">df_sort</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">day1_ranking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solar    3.0
Wind     2.0
Hydro    1.0
Name: Day 1, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="reshaping-melt-and-pivot">
<h1>🔁 Reshaping: <code class="docutils literal notranslate"><span class="pre">melt</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code><a class="headerlink" href="#reshaping-melt-and-pivot" title="Link to this heading">#</a></h1>
<p>Real-world datasets often need to be reshaped between <strong>wide</strong> and <strong>long</strong> formats depending on the analysis or visualization.</p>
<ul class="simple">
<li><p><strong>Wide format</strong> → columns represent variables (e.g., Solar, Wind, Hydro).</p></li>
<li><p><strong>Long format</strong> → each row represents a single observation (e.g., Day + Plant + MWh).</p></li>
</ul>
<p>👉 Pandas gives us <strong><code class="docutils literal notranslate"><span class="pre">melt()</span></code></strong> (wide → long) and <strong><code class="docutils literal notranslate"><span class="pre">pivot()</span></code></strong> (long → wide).</p>
<section id="why-this-matters">
<h2>🔎 Why This Matters<a class="headerlink" href="#why-this-matters" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">melt()</span></code></strong> → useful for feeding data into ML models or plotting libraries (which often expect long format).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pivot()</span></code></strong> → useful when you want a table-like format for reports or calculations.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span><span class="s2">&quot;Day 2&quot;</span><span class="p">,</span><span class="s2">&quot;Day 3&quot;</span><span class="p">,</span><span class="s2">&quot;Day 4&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hydro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span><span class="mi">310</span><span class="p">,</span><span class="mi">305</span><span class="p">,</span><span class="mi">295</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day</th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Hydro</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Day 1</td>
      <td>120</td>
      <td>200</td>
      <td>300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Day 2</td>
      <td>135</td>
      <td>210</td>
      <td>310</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day 3</td>
      <td>150</td>
      <td>190</td>
      <td>305</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Day 4</td>
      <td>160</td>
      <td>220</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long</span> <span class="o">=</span> <span class="n">wide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;MWh&quot;</span><span class="p">)</span>
<span class="n">long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day</th>
      <th>Plant</th>
      <th>MWh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Day 1</td>
      <td>Solar</td>
      <td>120</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Day 2</td>
      <td>Solar</td>
      <td>135</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day 3</td>
      <td>Solar</td>
      <td>150</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Day 4</td>
      <td>Solar</td>
      <td>160</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Day 1</td>
      <td>Wind</td>
      <td>200</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Day 2</td>
      <td>Wind</td>
      <td>210</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Day 3</td>
      <td>Wind</td>
      <td>190</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Day 4</td>
      <td>Wind</td>
      <td>220</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Day 1</td>
      <td>Hydro</td>
      <td>300</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Day 2</td>
      <td>Hydro</td>
      <td>310</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Day 3</td>
      <td>Hydro</td>
      <td>305</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Day 4</td>
      <td>Hydro</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivoted</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;MWh&quot;</span><span class="p">)</span>
<span class="n">pivoted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Plant</th>
      <th>Hydro</th>
      <th>Solar</th>
      <th>Wind</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>300</td>
      <td>120</td>
      <td>200</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>310</td>
      <td>135</td>
      <td>210</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>305</td>
      <td>150</td>
      <td>190</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>295</td>
      <td>160</td>
      <td>220</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pivot-tables">
<h2>📊 Pivot Tables<a class="headerlink" href="#pivot-tables" title="Link to this heading">#</a></h2>
<p>Aggregate with multiple dimensions (like Excel pivot).</p>
<p>⚡ Example: average MWh by <strong>Day</strong> and <strong>Plant</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day</th>
      <th>Plant</th>
      <th>MWh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Day 1</td>
      <td>Solar</td>
      <td>120</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Day 2</td>
      <td>Solar</td>
      <td>135</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day 3</td>
      <td>Solar</td>
      <td>150</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Day 4</td>
      <td>Solar</td>
      <td>160</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Day 1</td>
      <td>Wind</td>
      <td>200</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Day 2</td>
      <td>Wind</td>
      <td>210</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Day 3</td>
      <td>Wind</td>
      <td>190</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Day 4</td>
      <td>Wind</td>
      <td>220</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Day 1</td>
      <td>Hydro</td>
      <td>300</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Day 2</td>
      <td>Hydro</td>
      <td>310</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Day 3</td>
      <td>Hydro</td>
      <td>305</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Day 4</td>
      <td>Hydro</td>
      <td>295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pivot_table</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Plant&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;MWh&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="n">pivot_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Plant</th>
      <th>Hydro</th>
      <th>Solar</th>
      <th>Wind</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Day 1</th>
      <td>300.0</td>
      <td>120.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>Day 2</th>
      <td>310.0</td>
      <td>135.0</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>Day 3</th>
      <td>305.0</td>
      <td>150.0</td>
      <td>190.0</td>
    </tr>
    <tr>
      <th>Day 4</th>
      <td>295.0</td>
      <td>160.0</td>
      <td>220.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="indexing-set-index-reset-index-multiindex">
<h2>🧱 Indexing: <code class="docutils literal notranslate"><span class="pre">set_index</span></code>, <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>, MultiIndex<a class="headerlink" href="#indexing-set-index-reset-index-multiindex" title="Link to this heading">#</a></h2>
<p>Control row labels and create hierarchical indexes.</p>
<p>⚡ Energy example: MultiIndex by <strong>Day</strong> and <strong>Plant</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span><span class="s2">&quot;Plant&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">mi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>MWh</th>
    </tr>
    <tr>
      <th>Day</th>
      <th>Plant</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Day 1</th>
      <th>Hydro</th>
      <td>300</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>120</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>200</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Day 2</th>
      <th>Hydro</th>
      <td>310</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>135</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>210</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Day 3</th>
      <th>Hydro</th>
      <td>305</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>150</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>190</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Day 4</th>
      <th>Hydro</th>
      <td>295</td>
    </tr>
    <tr>
      <th>Solar</th>
      <td>160</td>
    </tr>
    <tr>
      <th>Wind</th>
      <td>220</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day</th>
      <th>Plant</th>
      <th>MWh</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Day 1</td>
      <td>Hydro</td>
      <td>300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Day 1</td>
      <td>Solar</td>
      <td>120</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day 1</td>
      <td>Wind</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Day 2</td>
      <td>Hydro</td>
      <td>310</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Day 2</td>
      <td>Solar</td>
      <td>135</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Day 2</td>
      <td>Wind</td>
      <td>210</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Day 3</td>
      <td>Hydro</td>
      <td>305</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Day 3</td>
      <td>Solar</td>
      <td>150</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Day 3</td>
      <td>Wind</td>
      <td>190</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Day 4</td>
      <td>Hydro</td>
      <td>295</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Day 4</td>
      <td>Solar</td>
      <td>160</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Day 4</td>
      <td>Wind</td>
      <td>220</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="datetime-time-series">
<h1>⏱️ DateTime / Time Series<a class="headerlink" href="#datetime-time-series" title="Link to this heading">#</a></h1>
<p>Parse dates, set as index, resample.</p>
<p>⚡ Example: daily → weekly totals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Solar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">155</span><span class="p">],</span>
    <span class="s2">&quot;Wind&quot;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">205</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">ts</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-01-01</th>
      <td>120</td>
      <td>200</td>
      <td>320</td>
    </tr>
    <tr>
      <th>2025-01-02</th>
      <td>130</td>
      <td>210</td>
      <td>340</td>
    </tr>
    <tr>
      <th>2025-01-03</th>
      <td>140</td>
      <td>220</td>
      <td>360</td>
    </tr>
    <tr>
      <th>2025-01-04</th>
      <td>160</td>
      <td>190</td>
      <td>350</td>
    </tr>
    <tr>
      <th>2025-01-05</th>
      <td>180</td>
      <td>205</td>
      <td>385</td>
    </tr>
    <tr>
      <th>2025-01-06</th>
      <td>150</td>
      <td>215</td>
      <td>365</td>
    </tr>
    <tr>
      <th>2025-01-07</th>
      <td>140</td>
      <td>225</td>
      <td>365</td>
    </tr>
    <tr>
      <th>2025-01-08</th>
      <td>135</td>
      <td>230</td>
      <td>365</td>
    </tr>
    <tr>
      <th>2025-01-09</th>
      <td>145</td>
      <td>210</td>
      <td>355</td>
    </tr>
    <tr>
      <th>2025-01-10</th>
      <td>155</td>
      <td>205</td>
      <td>360</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Weekly totals (Mon-Sun by default)</span>
<span class="n">weekly</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">weekly</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Solar</th>
      <th>Wind</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-01-05</th>
      <td>730</td>
      <td>1025</td>
      <td>1755</td>
    </tr>
    <tr>
      <th>2025-01-12</th>
      <td>725</td>
      <td>1085</td>
      <td>1810</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="string-operations">
<h1>🔤 String Operations<a class="headerlink" href="#string-operations" title="Link to this heading">#</a></h1>
<p>Vectorized string methods with <code class="docutils literal notranslate"><span class="pre">.str</span></code>.</p>
<p>⚡ Example: clean plant labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;  SOLAR  &quot;</span><span class="p">,</span> <span class="s2">&quot;wind-farm&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro_Plant&quot;</span><span class="p">])</span>
<span class="n">clean</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          Solar
1      Wind Farm
2    Hydro Plant
dtype: object
</pre></div>
</div>
</div>
</div>
<p>In Pandas string methods, <code class="docutils literal notranslate"><span class="pre">.str.replace()</span></code> can work in <strong>two modes</strong>:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">regex=False</span></code></strong> → the pattern is treated as <strong>plain text</strong>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">regex=True</span></code> (default)</strong> → the pattern is treated as a <strong>regular expression (regex)</strong>.</p></li>
</ul>
<p>We need <strong>regex</strong> when:</p>
<ul class="simple">
<li><p>We want to match <strong>patterns</strong> instead of exact text.</p></li>
<li><p>Example: replace <strong>any sequence of spaces, hyphens, or underscores</strong> with a single space.</p></li>
</ul>
<hr class="docutils" />
<section id="more-powerful-regex-example">
<h2>⚡ More Powerful Regex Example<a class="headerlink" href="#more-powerful-regex-example" title="Link to this heading">#</a></h2>
<p>Suppose we want to replace <strong>any non-letter character</strong> (<code class="docutils literal notranslate"><span class="pre">[^A-Za-z]</span></code>) with a space:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;  SOLAR  &quot;</span><span class="p">,</span> <span class="s2">&quot;wind-farm&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydro_Plant&quot;</span><span class="p">,</span> <span class="s2">&quot;Bio*Mass!&quot;</span><span class="p">])</span>
<span class="n">clean</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^A-Za-z]&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># replace non-letters</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>                                <span class="c1"># remove extra spaces</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>                              <span class="c1"># join words back</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          Solar
1      Wind Farm
2    Hydro Plant
3       Bio Mass
dtype: object
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="key-takeaway">
<h3>🔎 Key Takeaway<a class="headerlink" href="#key-takeaway" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Without regex</strong> → you must replace characters one by one (<code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;_&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code>, etc.).</p></li>
<li><p><strong>With regex</strong> → you can define a <strong>pattern</strong> once (like “non-letters”) and clean in a single step.</p></li>
</ul>
<p>👉 Regex makes string cleaning much more <strong>powerful and flexible</strong>, especially in messy energy datasets (plant names, region codes, sensor IDs).</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="categoricals">
<h1>🏷️ Categoricals<a class="headerlink" href="#categoricals" title="Link to this heading">#</a></h1>
<p>Use category dtype to save memory and define order.</p>
<p>⚡ Example: ordered <strong>Region</strong> categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;North&quot;</span><span class="p">,</span><span class="s2">&quot;West&quot;</span><span class="p">,</span><span class="s2">&quot;East&quot;</span><span class="p">,</span><span class="s2">&quot;East&quot;</span><span class="p">,</span><span class="s2">&quot;North&quot;</span><span class="p">])</span>
<span class="n">regions_cat</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regions_cat</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regions_cat</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>category
Index([&#39;East&#39;, &#39;North&#39;, &#39;West&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="window-functions-rolling">
<h1>🪟 Window Functions (<code class="docutils literal notranslate"><span class="pre">rolling</span></code>)<a class="headerlink" href="#window-functions-rolling" title="Link to this heading">#</a></h1>
<p>Compute rolling statistics over time windows.</p>
<p>⚡ Energy example: 3-day rolling <strong>mean</strong> of total production.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Total&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">360</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">))</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-01-01</th>
      <td>300</td>
    </tr>
    <tr>
      <th>2025-01-02</th>
      <td>320</td>
    </tr>
    <tr>
      <th>2025-01-03</th>
      <td>340</td>
    </tr>
    <tr>
      <th>2025-01-04</th>
      <td>310</td>
    </tr>
    <tr>
      <th>2025-01-05</th>
      <td>305</td>
    </tr>
    <tr>
      <th>2025-01-06</th>
      <td>330</td>
    </tr>
    <tr>
      <th>2025-01-07</th>
      <td>360</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roll_mean</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">roll_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-01    300.000000
2025-01-02    310.000000
2025-01-03    320.000000
2025-01-04    323.333333
2025-01-05    318.333333
2025-01-06    315.000000
2025-01-07    331.666667
Freq: D, Name: Total, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="renaming-columns-and-rows">
<h1>✏️ Renaming Columns and Rows<a class="headerlink" href="#renaming-columns-and-rows" title="Link to this heading">#</a></h1>
<p>Sometimes you need to <strong>rename columns or row labels</strong> to make your dataset clearer or standardized.
In Pandas, we use <strong><code class="docutils literal notranslate"><span class="pre">.rename()</span></code></strong> for this.</p>
<section id="key-notes">
<h2>🔎 Key Notes<a class="headerlink" href="#key-notes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.rename(columns={...})</span></code></strong> → rename columns.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.rename(index={...})</span></code></strong> → rename rows (index).</p></li>
<li><p>You can also use <code class="docutils literal notranslate"><span class="pre">df.columns</span> <span class="pre">=</span> <span class="pre">[...]</span></code> to rename all columns at once.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="renaming-columns">
<h2>⚡ Renaming Columns<a class="headerlink" href="#renaming-columns" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Energy production dataset (MWh)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Sol&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">],</span>
    <span class="s2">&quot;Wnd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
    <span class="s2">&quot;Hyd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">295</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 4&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before renaming:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># Rename columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Sol&quot;</span><span class="p">:</span> <span class="s2">&quot;Solar&quot;</span><span class="p">,</span> <span class="s2">&quot;Wnd&quot;</span><span class="p">:</span> <span class="s2">&quot;Wind&quot;</span><span class="p">,</span> <span class="s2">&quot;Hyd&quot;</span><span class="p">:</span> <span class="s2">&quot;Hydro&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After renaming:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before renaming:
        Sol  Wnd  Hyd
Day 1  120  200  300
Day 2  135  210  310
Day 3  150  190  305
Day 4  160  220  295

After renaming:
        Solar  Wind  Hydro
Day 1    120   200    300
Day 2    135   210    310
Day 3    150   190    305
Day 4    160   220    295
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="renaming-rows-index">
<h2>⚡ Renaming Rows (Index)<a class="headerlink" href="#renaming-rows-index" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename index labels (rows)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Day 1&quot;</span><span class="p">:</span> <span class="s2">&quot;Monday&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">:</span> <span class="s2">&quot;Tuesday&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Solar  Wind  Hydro
Monday     120   200    300
Tuesday    135   210    310
Day 3      150   190    305
Day 4      160   220    295
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_numpy_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">🔢 NumPy</p>
      </div>
    </a>
    <a class="right-next"
       href="04_data_science_cycle.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">🔄 Data Science Lifecycle</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">🐼 Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">📌 What is Pandas?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">📦 Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import">🐍 Import</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#series">📊 Series</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframes">🏢 Pandas: DataFrames</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries-vs-data-frame-difference-df-x-vs-df-x">🔎 Timeseries vs. Data frame. Difference: <code class="docutils literal notranslate"><span class="pre">df['x']</span></code> vs <code class="docutils literal notranslate"><span class="pre">df[['x']]</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-difference">🎯 Key Difference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-demand-series">✅ <code class="docutils literal notranslate"><span class="pre">df['demand']</span></code> → <strong>Series</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-demand-dataframe">✅ <code class="docutils literal notranslate"><span class="pre">df[['Demand']]</span></code> → <strong>DataFrame</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-data-in-pandas">📋 Inspecting Data in Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-df-info">ℹ️ <code class="docutils literal notranslate"><span class="pre">df.info()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-index-and-df-columns">🏷️ <code class="docutils literal notranslate"><span class="pre">df.index</span></code> and <code class="docutils literal notranslate"><span class="pre">df.columns</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#df-head-and-df-tail">👀 <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#len-df">📏 <code class="docutils literal notranslate"><span class="pre">len(df)</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">📊 Descriptive Statistics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics-with-describe">📊 Descriptive Statistics with <code class="docutils literal notranslate"><span class="pre">.describe()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics-for-mixed-data">📊 Descriptive Statistics for Mixed Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notes">🔎 Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-counts-with-value-counts">🔢 Frequency Counts with <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-its-useful">🔎 Why it’s useful?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unique-values-with-unique-and-nunique">🎯 Unique Values with <code class="docutils literal notranslate"><span class="pre">.unique()</span></code> and <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">🔎 Why it’s useful?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-rows-and-columns-in-pandas">📑 Accessing Rows and Columns in Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-columns">🎯 Calling Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-rows">🎯 Calling Rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rows-columns-together">🎯 Rows + Columns Together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">📌 Summary</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#selection-helpers-at-and-iat">🎯 Selection Helpers: <code class="docutils literal notranslate"><span class="pre">.at[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iat[]</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-points">🔎 Key Points</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-rows-and-columns">🗑️ Dropping Rows and Columns</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">🔗 Concatenation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#row-wise-concatenation">📑 Row-wise Concatenation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#column-wise-concatenation">📑 Column-wise Concatenation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">🔎 Key Points</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#joins-and-merges">🔀 Joins and Merges</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">🔎 Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-join-default">✅ Inner Join (default)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#left-join">✅ Left Join</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#right-join">✅ Right Join</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-join">✅ Outer Join</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">🔎 Filtering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-boolean-masks">🔎 Filtering (Boolean Masks)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-with-query">🔎 Filtering with <code class="docutils literal notranslate"><span class="pre">.query()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-benefits">🔎 Key Benefits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-columns-apply">➕ Derived Columns &amp; <code class="docutils literal notranslate"><span class="pre">.apply()</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-apply">🔎 Why use <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby-aggregations">🧮 GroupBy &amp; Aggregations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">🔎 Key Points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-totals-by-plant">⚡ Example: Totals by Plant</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-multiple-columns">⚡ Group by Multiple Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-agg-with-custom-functions">⚡ Using <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> with Custom Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-ranking">🧭 Sorting &amp; Ranking</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-melt-and-pivot">🔁 Reshaping: <code class="docutils literal notranslate"><span class="pre">melt</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters">🔎 Why This Matters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-tables">📊 Pivot Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing-set-index-reset-index-multiindex">🧱 Indexing: <code class="docutils literal notranslate"><span class="pre">set_index</span></code>, <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>, MultiIndex</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime-time-series">⏱️ DateTime / Time Series</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#string-operations">🔤 String Operations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-powerful-regex-example">⚡ More Powerful Regex Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaway">🔎 Key Takeaway</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#categoricals">🏷️ Categoricals</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#window-functions-rolling">🪟 Window Functions (<code class="docutils literal notranslate"><span class="pre">rolling</span></code>)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns-and-rows">✏️ Renaming Columns and Rows</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-notes">🔎 Key Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns">⚡ Renaming Columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-rows-index">⚡ Renaming Rows (Index)</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Margarita Matson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright © 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>